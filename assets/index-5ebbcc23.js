import{r as e,Q as t,am as r,U as a,V as s,$ as o,W as n,aL as i,bv as l,bc as c,aE as p,X as g,c0 as d,aT as u,ap as m}from"./index-b4cdc21f.js";import{P as f}from"./index-bff7078e.js";const v=e.createContext({}),b=e=>{const{antCls:t,componentCls:r,iconCls:o,avatarBg:n,avatarColor:i,containerSize:l,containerSizeLG:c,containerSizeSM:p,textFontSize:g,textFontSizeLG:d,textFontSizeSM:u,borderRadius:m,borderRadiusLG:f,borderRadiusSM:v,lineWidth:b,lineType:h}=e,S=(e,t,a)=>({width:e,height:e,borderRadius:"50%",[`&${r}-square`]:{borderRadius:a},[`&${r}-icon`]:{fontSize:t,[`> ${o}`]:{margin:0}}});return{[r]:Object.assign(Object.assign(Object.assign(Object.assign({},a(e)),{position:"relative",display:"inline-flex",justifyContent:"center",alignItems:"center",overflow:"hidden",color:i,whiteSpace:"nowrap",textAlign:"center",verticalAlign:"middle",background:n,border:`${s(b)} ${h} transparent`,"&-image":{background:"transparent"},[`${t}-image-img`]:{display:"block"}}),S(l,g,m)),{"&-lg":Object.assign({},S(c,d,f)),"&-sm":Object.assign({},S(p,u,v)),"> img":{display:"block",width:"100%",height:"100%",objectFit:"cover"}})}},h=e=>{const{componentCls:t,groupBorderColor:r,groupOverlapping:a,groupSpace:s}=e;return{[`${t}-group`]:{display:"inline-flex",[t]:{borderColor:r},"> *:not(:first-child)":{marginInlineStart:a}},[`${t}-group-popover`]:{[`${t} + ${t}`]:{marginInlineStart:s}}}},S=t("Avatar",(e=>{const{colorTextLightSolid:t,colorTextPlaceholder:a}=e,s=r(e,{avatarBg:a,avatarColor:t});return[b(s),h(s)]}),(e=>{const{controlHeight:t,controlHeightLG:r,controlHeightSM:a,fontSize:s,fontSizeLG:o,fontSizeXL:n,fontSizeHeading3:i,marginXS:l,marginXXS:c,colorBorderBg:p}=e;return{containerSize:t,containerSizeLG:r,containerSizeSM:a,textFontSize:Math.round((o+n)/2),textFontSizeLG:i,textFontSizeSM:s,groupSpace:c,groupOverlapping:-l,groupBorderColor:p}}));var y=globalThis&&globalThis.__rest||function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(r[a[s]]=e[a[s]])}return r};const x=(t,r)=>{const[a,s]=e.useState(1),[u,m]=e.useState(!1),[f,b]=e.useState(!0),h=e.useRef(null),x=e.useRef(null),O=o(r,h),{getPrefixCls:z,avatar:j}=e.useContext(n),C=e.useContext(v),$=()=>{if(!x.current||!h.current)return;const e=x.current.offsetWidth,r=h.current.offsetWidth;if(0!==e&&0!==r){const{gap:a=4}=t;2*a<r&&s(r-2*a<e?(r-2*a)/e:1)}};e.useEffect((()=>{m(!0)}),[]),e.useEffect((()=>{b(!0),s(1)}),[t.src]),e.useEffect($,[t.gap]);const E=()=>{const{onError:e}=t;!1!==(null==e?void 0:e())&&b(!1)},{prefixCls:N,shape:w,size:P,src:k,srcSet:L,icon:T,className:M,rootClassName:R,alt:G,draggable:F,children:B,crossOrigin:H}=t,W=y(t,["prefixCls","shape","size","src","srcSet","icon","className","rootClassName","alt","draggable","children","crossOrigin"]),X=i((e=>{var t,r;return null!==(r=null!==(t=null!=P?P:null==C?void 0:C.size)&&void 0!==t?t:e)&&void 0!==r?r:"default"})),A=Object.keys("object"==typeof X&&X||{}).some((e=>["xs","sm","md","lg","xl","xxl"].includes(e))),I=l(A),V=e.useMemo((()=>{if("object"!=typeof X)return{};const e=c.find((e=>I[e])),t=X[e];return t?{width:t,height:t,fontSize:t&&(T||B)?t/2:18}:{}}),[I,X]),_=z("avatar",N),q=p(_),[Q,U,D]=S(_,q),J=g({[`${_}-lg`]:"large"===X,[`${_}-sm`]:"small"===X}),K=e.isValidElement(k),Y=w||(null==C?void 0:C.shape)||"circle",Z=g(_,J,null==j?void 0:j.className,`${_}-${Y}`,{[`${_}-image`]:K||k&&f,[`${_}-icon`]:!!T},D,q,M,R,U),ee="number"==typeof X?{width:X,height:X,fontSize:T?X/2:18}:{};let te;if("string"==typeof k&&f)te=e.createElement("img",{src:k,draggable:F,srcSet:L,onError:E,alt:G,crossOrigin:H});else if(K)te=k;else if(T)te=T;else if(u||1!==a){const t=`scale(${a})`,r={msTransform:t,WebkitTransform:t,transform:t};te=e.createElement(d,{onResize:$},e.createElement("span",{className:`${_}-string`,ref:x,style:Object.assign({},r)},B))}else te=e.createElement("span",{className:`${_}-string`,style:{opacity:0},ref:x},B);return delete W.onError,delete W.gap,Q(e.createElement("span",Object.assign({},W,{style:Object.assign(Object.assign(Object.assign(Object.assign({},ee),V),null==j?void 0:j.style),W.style),className:Z,ref:O}),te))},O=e.forwardRef(x),z=t=>{const{size:r,shape:a}=e.useContext(v),s=e.useMemo((()=>({size:t.size||r,shape:t.shape||a})),[t.size,t.shape,r,a]);return e.createElement(v.Provider,{value:s},t.children)},j=t=>{var r,a,s;const{getPrefixCls:o,direction:i}=e.useContext(n),{prefixCls:l,className:c,rootClassName:d,style:v,maxCount:b,maxStyle:h,size:y,shape:x,maxPopoverPlacement:j,maxPopoverTrigger:C,children:$,max:E}=t,N=o("avatar",l),w=`${N}-group`,P=p(N),[k,L,T]=S(N,P),M=g(w,{[`${w}-rtl`]:"rtl"===i},T,P,c,d,L),R=u($).map(((e,t)=>m(e,{key:`avatar-key-${t}`}))),G=(null==E?void 0:E.count)||b,F=R.length;if(G&&G<F){const t=R.slice(0,G),o=R.slice(G,F),n=(null==E?void 0:E.style)||h,i=(null===(r=null==E?void 0:E.popover)||void 0===r?void 0:r.trigger)||C||"hover",l=(null===(a=null==E?void 0:E.popover)||void 0===a?void 0:a.placement)||j||"top",c=Object.assign(Object.assign({content:o},null==E?void 0:E.popover),{overlayClassName:g(`${w}-popover`,null===(s=null==E?void 0:E.popover)||void 0===s?void 0:s.overlayClassName),placement:l,trigger:i});return t.push(e.createElement(f,Object.assign({key:"avatar-popover-key",destroyTooltipOnHide:!0},c),e.createElement(O,{style:n},"+"+(F-G)))),k(e.createElement(z,{shape:x,size:y},e.createElement("div",{className:M,style:v},t)))}return k(e.createElement(z,{shape:x,size:y},e.createElement("div",{className:M,style:v},R)))},C=O;C.Group=j;const $=C;export{$ as A};
