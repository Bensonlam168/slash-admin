import{F as s,r as e,Q as t,j as a,M as r,ac as n,ad as o,W as l,J as i}from"./.pnpm-05c560be.js";import{I as c}from"./index-56568590.js";import d from"./kanban-column-d4fc27a3.js";import{T as m,a as u,D as p}from"./kanban-task-3f854638.js";import"./task-detail-77917dd3.js";const k=e=>{const t=[];for(let a=0;a<e;a+=1)t.push({username:s.person.fullName(),avatar:s.image.avatarLegacy(),content:s.lorem.lines({min:1,max:3}),time:s.date.past()});return t},f=e=>{const t=[];for(let a=0;a<e;a+=1)t.push(s.image.urlPicsumPhotos());return t},g=e=>{const t=[];for(let a=0;a<e;a+=1)t.push(s.image.avatarLegacy());return t},x=e=>{const t=[],a=new Set;for(;t.length<e;){const e=s.helpers.enumValue(u);a.has(e)||(t.push(e),a.add(e))}return t},I={tasks:{"task-1":{id:"task-1",title:s.lorem.words(3),reporter:s.image.avatarLegacy(),priority:m.LOW,tags:[],comments:[],attachments:[]},"task-2":{id:"task-2",title:s.lorem.words(3),reporter:s.image.avatarLegacy(),assignee:g(1),date:s.date.future(),priority:m.HIGH,tags:x(3),comments:k(1),attachments:f(4)},"task-3":{id:"task-3",title:s.lorem.words(4),reporter:s.image.avatarLegacy(),assignee:g(2),priority:m.MEDIUM,date:s.date.future(),tags:x(2),comments:k(2),attachments:[]},"task-4":{id:"task-4",title:s.lorem.words(5),reporter:s.image.avatar(),assignee:g(3),priority:m.MEDIUM,tags:x(3),date:s.date.future(),description:s.lorem.lines(5),attachments:[],comments:k(3)},"task-5":{id:"task-5",title:s.lorem.words(4),reporter:s.image.avatar(),priority:m.HIGH,assignee:g(4),tags:x(4),date:s.date.future(),description:s.lorem.lines(3),attachments:[],comments:k(4)},"task-6":{id:"task-6",title:s.lorem.words(5),reporter:s.image.avatar(),priority:m.LOW,assignee:g(5),tags:x(5),date:s.date.future(),description:s.lorem.lines(4),attachments:f(5),comments:k(4)}},columns:{"column-1":{id:"column-1",title:"To do",taskIds:["task-1","task-2","task-3"]},"column-2":{id:"column-2",title:"In progress",taskIds:["task-4","task-5"]},"column-3":{id:"column-3",title:"Done",taskIds:["task-6"]}},columnOrder:["column-1","column-2","column-3"]};function h(){const[m,u]=e.useState(I),[k,f]=e.useState(!1),g=e.useRef(null);t("click",(e=>{if(g.current&&!g.current.input?.contains(e.target)){const e=g.current.input?.value;e&&x({id:s.string.uuid(),title:e,taskIds:[]}),f(!1)}}));const x=s=>{const e={...m,columns:{...m.columns,[s.id]:s},columnOrder:[...m.columnOrder,s.id]};u(e)},h=(s,e)=>{const t=m.columns[s],a={...m,tasks:{...m.tasks,[e.id]:e},columns:{...m.columns,[s]:{...t,taskIds:[...t.taskIds,e.id]}}};u(a)},y=s=>{const e=m.columns[s],t=Object.keys(m.tasks).filter((s=>!e.taskIds.includes(s))).reduce(((s,e)=>(s[e]=m.tasks[e],s)),{}),a=Object.keys(m.columns).filter((e=>e!==s)).reduce(((s,e)=>(s[e]=m.columns[e],s)),{}),r=Array.from(m.columnOrder).filter((e=>e!==s));u({tasks:t,columns:a,columnOrder:r})},j=s=>{const e=m.columns[s],t=Object.keys(m.tasks).filter((s=>!e.taskIds.includes(s))).reduce(((s,e)=>(s[e]=m.tasks[e],s)),{}),a={...m.columns,[s]:{...e,taskIds:[]}},r={...m,tasks:t,columns:a};u(r)},b=s=>{const{id:e,title:t}=s,a={...m.columns,[e]:{...m.columns[e],title:t}},r={...m,columns:a};u(r)};return a.jsx(r,{children:a.jsxs("div",{className:"flex",children:[a.jsx(n,{onDragEnd:s=>{const{source:e,destination:t,type:a}=s;t&&(t.droppableId===e.droppableId&&t.index===e.index||(a===p.COLUMN?(s=>{const{source:e,destination:t,draggableId:a}=s,r=Array.from(m.columnOrder);r.splice(e.index,1),r.splice(t.index,0,a);const n={...m,columnOrder:r};u(n)})(s):(s=>{const{source:e,destination:t,draggableId:a}=s,r=m.columns[e.droppableId],n=m.columns[t.droppableId];if(r===n){const s=Array.from(r.taskIds);s.splice(e.index,1),s.splice(t.index,0,a);const n={...r,taskIds:s},o={...m,columns:{...m.columns,[n.id]:n}};u(o)}else{const s=Array.from(r.taskIds);s.splice(e.index,1);const o={...r,taskIds:s},l=Array.from(n.taskIds);l.splice(t.index,0,a);const i={...n,taskIds:l},c={...m,columns:{...m.columns,[o.id]:o,[i.id]:i}};u(c)}})(s)))},children:a.jsx(o,{droppableId:"all-columns",direction:"horizontal",type:p.COLUMN,children:s=>a.jsxs("div",{ref:s.innerRef,...s.droppableProps,className:"flex h-full items-start gap-6 p-1",children:[m.columnOrder.map(((s,e)=>{const t=m.columns[s],r=t.taskIds.map((s=>m.tasks[s]));return a.jsx(d,{index:e,column:t,tasks:r,createTask:h,clearColumn:j,deleteColumn:y,renameColumn:b},s)})),s.placeholder]})})}),a.jsx("div",{className:"ml-[1.6rem] mt-[0.25rem] min-w-[280px]",children:k?a.jsx(l,{ref:g,size:"large",placeholder:"Column Name",autoFocus:!0}):a.jsxs(i,{onClick:s=>{s.stopPropagation(),f(!0)},className:"!inline-flex !w-full items-center justify-center !text-xs !font-semibold",block:!0,size:"large",children:[a.jsx(c,{icon:"carbon:add",size:20}),a.jsx("div",{children:"Add Column"})]})})]})})}export{h as default};
