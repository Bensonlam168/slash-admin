import{cy as e,cz as t,cA as s,cB as r,cC as i,cD as n,cE as a,cF as o,cG as l,cH as c,cI as u,r as h,cJ as d,cK as p,cL as f,cM as m,j as y,y as R,g as x,ae as v,ac as b,af as j,cj as g,I as S,cN as I,cO as C}from"./index-adbc297b.js";import{T as O}from"./Table-41c14068.js";import Q from"./organization-chart-e327a949.js";import{F as E}from"./index-03d69761.js";import{R as w,C as T}from"./row-3052e149.js";import{S as F}from"./index-ec854b6d.js";import{P as U}from"./index-b265dfbb.js";import{I as k}from"./index-069fe078.js";import{R as D}from"./index-01b89e52.js";import"./addEventListener-a08b4908.js";import"./List-489e496c.js";import"./Pagination-331bc15c.js";import"./index-d62a0209.js";import"./index-504ec023.js";import"./index-c6f386e6.js";import"./index-43f259b3.js";import"./iconUtil-c71794a5.js";import"./extendsObject-8d078517.js";import"./index-21cd6078.js";class P extends e{constructor(e,t){super(),this.client=e,this.options=t,this.trackedProps=new Set,this.selectError=null,this.bindMethods(),this.setOptions(t)}bindMethods(){this.remove=this.remove.bind(this),this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(this.currentQuery.addObserver(this),A(this.currentQuery,this.options)&&this.executeFetch(),this.updateTimers())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return L(this.currentQuery,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return L(this.currentQuery,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.clearStaleTimeout(),this.clearRefetchInterval(),this.currentQuery.removeObserver(this)}setOptions(e,s){const r=this.options,i=this.currentQuery;if(this.options=this.client.defaultQueryOptions(e),t(r,this.options)||this.client.getQueryCache().notify({type:"observerOptionsUpdated",query:this.currentQuery,observer:this}),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled)throw new Error("Expected enabled to be a boolean");this.options.queryKey||(this.options.queryKey=r.queryKey),this.updateQuery();const n=this.hasListeners();n&&N(this.currentQuery,i,this.options,r)&&this.executeFetch(),this.updateResult(s),!n||this.currentQuery===i&&this.options.enabled===r.enabled&&this.options.staleTime===r.staleTime||this.updateStaleTimeout();const a=this.computeRefetchInterval();!n||this.currentQuery===i&&this.options.enabled===r.enabled&&a===this.currentRefetchInterval||this.updateRefetchInterval(a)}getOptimisticResult(e){const s=this.client.getQueryCache().build(this.client,e),r=this.createResult(s,e);return function(e,s,r){if(r.keepPreviousData)return!1;if(void 0!==r.placeholderData)return s.isPlaceholderData;if(!t(e.getCurrentResult(),s))return!0;return!1}(this,r,e)&&(this.currentResult=r,this.currentResultOptions=this.options,this.currentResultState=this.currentQuery.state),r}getCurrentResult(){return this.currentResult}trackResult(e){const t={};return Object.keys(e).forEach((s=>{Object.defineProperty(t,s,{configurable:!1,enumerable:!0,get:()=>(this.trackedProps.add(s),e[s])})})),t}getCurrentQuery(){return this.currentQuery}remove(){this.client.getQueryCache().remove(this.currentQuery)}refetch({refetchPage:e,...t}={}){return this.fetch({...t,meta:{refetchPage:e}})}fetchOptimistic(e){const t=this.client.defaultQueryOptions(e),s=this.client.getQueryCache().build(this.client,t);return s.isFetchingOptimistic=!0,s.fetch().then((()=>this.createResult(s,t)))}fetch(e){var t;return this.executeFetch({...e,cancelRefetch:null==(t=e.cancelRefetch)||t}).then((()=>(this.updateResult(),this.currentResult)))}executeFetch(e){this.updateQuery();let t=this.currentQuery.fetch(this.options,e);return null!=e&&e.throwOnError||(t=t.catch(s)),t}updateStaleTimeout(){if(this.clearStaleTimeout(),r||this.currentResult.isStale||!i(this.options.staleTime))return;const e=n(this.currentResult.dataUpdatedAt,this.options.staleTime)+1;this.staleTimeoutId=setTimeout((()=>{this.currentResult.isStale||this.updateResult()}),e)}computeRefetchInterval(){var e;return"function"==typeof this.options.refetchInterval?this.options.refetchInterval(this.currentResult.data,this.currentQuery):null!=(e=this.options.refetchInterval)&&e}updateRefetchInterval(e){this.clearRefetchInterval(),this.currentRefetchInterval=e,!r&&!1!==this.options.enabled&&i(this.currentRefetchInterval)&&0!==this.currentRefetchInterval&&(this.refetchIntervalId=setInterval((()=>{(this.options.refetchIntervalInBackground||a.isFocused())&&this.executeFetch()}),this.currentRefetchInterval))}updateTimers(){this.updateStaleTimeout(),this.updateRefetchInterval(this.computeRefetchInterval())}clearStaleTimeout(){this.staleTimeoutId&&(clearTimeout(this.staleTimeoutId),this.staleTimeoutId=void 0)}clearRefetchInterval(){this.refetchIntervalId&&(clearInterval(this.refetchIntervalId),this.refetchIntervalId=void 0)}createResult(e,t){const s=this.currentQuery,r=this.options,i=this.currentResult,n=this.currentResultState,a=this.currentResultOptions,c=e!==s,u=c?e.state:this.currentQueryInitialState,h=c?this.currentResult:this.previousQueryResult,{state:d}=e;let p,{dataUpdatedAt:f,error:m,errorUpdatedAt:y,fetchStatus:R,status:x}=d,v=!1,b=!1;if(t._optimisticResults){const i=this.hasListeners(),n=!i&&A(e,t),a=i&&N(e,s,t,r);(n||a)&&(R=o(e.options.networkMode)?"fetching":"paused",f||(x="loading")),"isRestoring"===t._optimisticResults&&(R="idle")}if(t.keepPreviousData&&!d.dataUpdatedAt&&null!=h&&h.isSuccess&&"error"!==x)p=h.data,f=h.dataUpdatedAt,x=h.status,v=!0;else if(t.select&&void 0!==d.data)if(i&&d.data===(null==n?void 0:n.data)&&t.select===this.selectFn)p=this.selectResult;else try{this.selectFn=t.select,p=t.select(d.data),p=l(null==i?void 0:i.data,p,t),this.selectResult=p,this.selectError=null}catch(I){this.selectError=I}else p=d.data;if(void 0!==t.placeholderData&&void 0===p&&"loading"===x){let e;if(null!=i&&i.isPlaceholderData&&t.placeholderData===(null==a?void 0:a.placeholderData))e=i.data;else if(e="function"==typeof t.placeholderData?t.placeholderData():t.placeholderData,t.select&&void 0!==e)try{e=t.select(e),this.selectError=null}catch(I){this.selectError=I}void 0!==e&&(x="success",p=l(null==i?void 0:i.data,e,t),b=!0)}this.selectError&&(m=this.selectError,p=this.selectResult,y=Date.now(),x="error");const j="fetching"===R,g="loading"===x,S="error"===x;return{status:x,fetchStatus:R,isLoading:g,isSuccess:"success"===x,isError:S,isInitialLoading:g&&j,data:p,dataUpdatedAt:f,error:m,errorUpdatedAt:y,failureCount:d.fetchFailureCount,failureReason:d.fetchFailureReason,errorUpdateCount:d.errorUpdateCount,isFetched:d.dataUpdateCount>0||d.errorUpdateCount>0,isFetchedAfterMount:d.dataUpdateCount>u.dataUpdateCount||d.errorUpdateCount>u.errorUpdateCount,isFetching:j,isRefetching:j&&!g,isLoadingError:S&&0===d.dataUpdatedAt,isPaused:"paused"===R,isPlaceholderData:b,isPreviousData:v,isRefetchError:S&&0!==d.dataUpdatedAt,isStale:z(e,t),refetch:this.refetch,remove:this.remove}}updateResult(e){const s=this.currentResult,r=this.createResult(this.currentQuery,this.options);if(this.currentResultState=this.currentQuery.state,this.currentResultOptions=this.options,t(r,s))return;this.currentResult=r;const i={cache:!0};!1!==(null==e?void 0:e.listeners)&&(()=>{if(!s)return!0;const{notifyOnChangeProps:e}=this.options,t="function"==typeof e?e():e;if("all"===t||!t&&!this.trackedProps.size)return!0;const r=new Set(null!=t?t:this.trackedProps);return this.options.useErrorBoundary&&r.add("error"),Object.keys(this.currentResult).some((e=>{const t=e;return this.currentResult[t]!==s[t]&&r.has(t)}))})()&&(i.listeners=!0),this.notify({...i,...e})}updateQuery(){const e=this.client.getQueryCache().build(this.client,this.options);if(e===this.currentQuery)return;const t=this.currentQuery;this.currentQuery=e,this.currentQueryInitialState=e.state,this.previousQueryResult=this.currentResult,this.hasListeners()&&(null==t||t.removeObserver(this),e.addObserver(this))}onQueryUpdate(e){const t={};"success"===e.type?t.onSuccess=!e.manual:"error"!==e.type||c(e.error)||(t.onError=!0),this.updateResult(t),this.hasListeners()&&this.updateTimers()}notify(e){u.batch((()=>{var t,s,r,i;if(e.onSuccess)null==(t=(s=this.options).onSuccess)||t.call(s,this.currentResult.data),null==(r=(i=this.options).onSettled)||r.call(i,this.currentResult.data,null);else if(e.onError){var n,a,o,l;null==(n=(a=this.options).onError)||n.call(a,this.currentResult.error),null==(o=(l=this.options).onSettled)||o.call(l,void 0,this.currentResult.error)}e.listeners&&this.listeners.forEach((({listener:e})=>{e(this.currentResult)})),e.cache&&this.client.getQueryCache().notify({query:this.currentQuery,type:"observerResultsUpdated"})}))}}function A(e,t){return function(e,t){return!(!1===t.enabled||e.state.dataUpdatedAt||"error"===e.state.status&&!1===t.retryOnMount)}(e,t)||e.state.dataUpdatedAt>0&&L(e,t,t.refetchOnMount)}function L(e,t,s){if(!1!==t.enabled){const r="function"==typeof s?s(e):s;return"always"===r||!1!==r&&z(e,t)}return!1}function N(e,t,s,r){return!1!==s.enabled&&(e!==t||!1===r.enabled)&&(!s.suspense||"error"!==e.state.status)&&z(e,s)}function z(e,t){return e.isStaleByTime(t.staleTime)}const q=h.createContext(!1),B=()=>h.useContext(q);q.Provider;const M=h.createContext(function(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}()),K=()=>h.useContext(M),V=(e,t)=>{(e.suspense||e.useErrorBoundary)&&(t.isReset()||(e.retryOnMount=!1))},_=e=>{h.useEffect((()=>{e.clearReset()}),[e])},W=({result:e,errorResetBoundary:t,useErrorBoundary:s,query:r})=>e.isError&&!t.isReset()&&!e.isFetching&&d(s,[e.error,r]),G=e=>{e.suspense&&"number"!=typeof e.staleTime&&(e.staleTime=1e3)},J=(e,t,s)=>(null==e?void 0:e.suspense)&&((e,t)=>e.isLoading&&e.isFetching&&!t)(t,s),Y=(e,t,s)=>t.fetchOptimistic(e).then((({data:t})=>{null==e.onSuccess||e.onSuccess(t),null==e.onSettled||e.onSettled(t,null)})).catch((t=>{s.clearReset(),null==e.onError||e.onError(t),null==e.onSettled||e.onSettled(void 0,t)}));function H(e,t,s){return function(e,t){const s=p({context:e.context}),r=B(),i=K(),n=s.defaultQueryOptions(e);n._optimisticResults=r?"isRestoring":"optimistic",n.onError&&(n.onError=u.batchCalls(n.onError)),n.onSuccess&&(n.onSuccess=u.batchCalls(n.onSuccess)),n.onSettled&&(n.onSettled=u.batchCalls(n.onSettled)),G(n),V(n,i),_(i);const[a]=h.useState((()=>new t(s,n))),o=a.getOptimisticResult(n);if(f(h.useCallback((e=>{const t=r?()=>{}:a.subscribe(u.batchCalls(e));return a.updateResult(),t}),[a,r]),(()=>a.getCurrentResult()),(()=>a.getCurrentResult())),h.useEffect((()=>{a.setOptions(n,{listeners:!1})}),[n,a]),J(n,o,r))throw Y(n,a,i);if(W({result:o,errorResetBoundary:i,useErrorBoundary:n.useErrorBoundary,query:a.getCurrentQuery()}))throw o.error;return n.notifyOnChangeProps?o:a.trackResult(o)}(m(e,t,s),P)}function X(){const[e]=E.useForm(),[t,s]=h.useState({formValue:{id:"",name:"",status:"enable"},title:"New",show:!1,onOk:()=>{s((e=>({...e,show:!1})))},onCancel:()=>{s((e=>({...e,show:!1})))}}),r=[{title:"Name",dataIndex:"name",width:300},{title:"Order",dataIndex:"order",align:"center",width:60},{title:"Status",dataIndex:"status",align:"center",width:120,render:e=>y.jsx(b,{color:"enable"===e?"success":"error",children:e})},{title:"Desc",dataIndex:"desc",align:"center",width:300},{title:"Action",key:"operation",align:"center",width:100,render:(e,t)=>y.jsxs("div",{className:"flex w-full justify-center text-gray",children:[y.jsx(g,{onClick:()=>n(t),children:y.jsx(S,{icon:"solar:pen-bold-duotone",size:18})}),y.jsx(U,{title:"Delete the Organization",okText:"Yes",cancelText:"No",placement:"left",children:y.jsx(g,{children:y.jsx(S,{icon:"mingcute:delete-2-fill",size:18,className:"text-error"})})})]})}],{data:i}=H({queryKey:["orgs"],queryFn:C.getOrgList}),n=e=>{s((t=>({...t,show:!0,title:"Edit",formValue:e})))};return y.jsxs(R,{direction:"vertical",size:"large",className:"w-full",children:[y.jsx(x,{children:y.jsx(E,{form:e,children:y.jsxs(w,{gutter:[16,16],children:[y.jsx(T,{span:24,lg:6,children:y.jsx(E.Item,{label:"Name",name:"name",className:"!mb-0",children:y.jsx(v,{})})}),y.jsx(T,{span:24,lg:6,children:y.jsx(E.Item,{label:"Status",name:"status",className:"!mb-0",children:y.jsxs(F,{children:[y.jsx(F.Option,{value:"enable",children:y.jsx(b,{color:"success",children:"Enable"})}),y.jsx(F.Option,{value:"disable",children:y.jsx(b,{color:"error",children:"Disable"})})]})})}),y.jsx(T,{span:24,lg:12,children:y.jsxs("div",{className:"flex justify-end",children:[y.jsx(j,{onClick:()=>{e.resetFields()},children:"Reset"}),y.jsx(j,{type:"primary",className:"ml-4",children:"Search"})]})})]})})}),y.jsx(x,{title:"Organization List",extra:y.jsx(j,{type:"primary",onClick:()=>{s((e=>({...e,show:!0,title:"Create New",formValue:{...e.formValue,id:"",name:"",order:1,desc:"",status:"enable"}})))},children:"New"}),children:y.jsx(O,{rowKey:"id",size:"small",scroll:{x:"max-content"},pagination:!1,columns:r,dataSource:i,rowSelection:{onChange:(e,t)=>{},onSelect:(e,t,s)=>{},onSelectAll:(e,t,s)=>{}}})}),y.jsx(x,{title:"Organization Chart",children:y.jsx(Q,{organizations:i})}),y.jsx(Z,{...t})]})}function Z({title:e,show:t,formValue:s,onOk:r,onCancel:i}){const[n]=E.useForm();return h.useEffect((()=>{n.setFieldsValue({...s})}),[s,n]),y.jsx(I,{title:e,open:t,onOk:r,onCancel:i,children:y.jsxs(E,{initialValues:s,form:n,labelCol:{span:4},wrapperCol:{span:18},layout:"horizontal",children:[y.jsx(E.Item,{label:"Name",name:"name",required:!0,children:y.jsx(v,{})}),y.jsx(E.Item,{label:"Order",name:"order",required:!0,children:y.jsx(k,{style:{width:"100%"}})}),y.jsx(E.Item,{label:"Status",name:"status",required:!0,children:y.jsxs(D.Group,{optionType:"button",buttonStyle:"solid",children:[y.jsx(D,{value:"enable",children:" Enable "}),y.jsx(D,{value:"disable",children:" Disable "})]})}),y.jsx(E.Item,{label:"Desc",name:"desc",children:y.jsx(v.TextArea,{})})]})})}export{X as default};
