import{x as n,r as I,d5 as N,j as u,d6 as M,d2 as P,d3 as z,a3 as H,a4 as R,I as U}from"./index-465e3387.js";import B from"./kanban-column-aefa01dc.js";import{T as p,a as F,D as O}from"./kanban-task-06b4ce85.js";import"./task-detail-b1966088.js";import"./dayjs.min-d07040e7.js";import"./index-92dd0e36.js";import"./CheckOutlined-1d9816ed.js";import"./styleChecker-9011c3aa.js";import"./index-2d764068.js";import"./index-a252f7ce.js";import"./index-8b4804e8.js";import"./index-fd0912c1.js";import"./index-5777443c.js";import"./index-0ab1f346.js";import"./addEventListener-5b882c5f.js";import"./index-6d260c19.js";const f=t=>{const a=[];for(let l=0;l<t;l+=1)a.push({username:n.person.fullName(),avatar:n.image.avatarLegacy(),content:n.lorem.lines({min:1,max:3}),time:n.date.past()});return a},b=t=>{const a=[];for(let l=0;l<t;l+=1)a.push(n.image.urlPicsumPhotos());return a},g=t=>{const a=[];for(let l=0;l<t;l+=1)a.push(n.image.avatarLegacy());return a},h=t=>{const a=[],l=new Set;for(;a.length<t;){const k=n.helpers.enumValue(F);l.has(k)||(a.push(k),l.add(k))}return a},G={tasks:{"task-1":{id:"task-1",title:n.lorem.words(3),reporter:n.image.avatarLegacy(),priority:p.LOW,tags:[],comments:[],attachments:[]},"task-2":{id:"task-2",title:n.lorem.words(3),reporter:n.image.avatarLegacy(),assignee:g(1),date:n.date.future(),priority:p.HIGH,tags:h(3),comments:f(1),attachments:b(4)},"task-3":{id:"task-3",title:n.lorem.words(4),reporter:n.image.avatarLegacy(),assignee:g(2),priority:p.MEDIUM,date:n.date.future(),tags:h(2),comments:f(2),attachments:[]},"task-4":{id:"task-4",title:n.lorem.words(5),reporter:n.image.avatar(),assignee:g(3),priority:p.MEDIUM,tags:h(3),date:n.date.future(),description:n.lorem.lines(5),attachments:[],comments:f(3)},"task-5":{id:"task-5",title:n.lorem.words(4),reporter:n.image.avatar(),priority:p.HIGH,assignee:g(4),tags:h(4),date:n.date.future(),description:n.lorem.lines(3),attachments:[],comments:f(4)},"task-6":{id:"task-6",title:n.lorem.words(5),reporter:n.image.avatar(),priority:p.LOW,assignee:g(5),tags:h(5),date:n.date.future(),description:n.lorem.lines(4),attachments:b(5),comments:f(4)}},columns:{"column-1":{id:"column-1",title:"To do",taskIds:["task-1","task-2","task-3"]},"column-2":{id:"column-2",title:"In progress",taskIds:["task-4","task-5"]},"column-3":{id:"column-3",title:"Done",taskIds:["task-6"]}},columnOrder:["column-1","column-2","column-3"]};function rt(){const[t,a]=I.useState(G),l=e=>{const{source:s,destination:r,draggableId:i}=e,c=t.columns[s.droppableId],m=t.columns[r.droppableId];if(c===m){const o=Array.from(c.taskIds);o.splice(s.index,1),o.splice(r.index,0,i);const d={...c,taskIds:o},w={...t,columns:{...t.columns,[d.id]:d}};a(w)}else{const o=Array.from(c.taskIds);o.splice(s.index,1);const d={...c,taskIds:o},w=Array.from(m.taskIds);w.splice(r.index,0,i);const y={...m,taskIds:w},L={...t,columns:{...t.columns,[d.id]:d,[y.id]:y}};a(L)}},k=e=>{const{source:s,destination:r,draggableId:i}=e,c=Array.from(t.columnOrder);c.splice(s.index,1),c.splice(r.index,0,i);const m={...t,columnOrder:c};a(m)},j=e=>{const{source:s,destination:r,type:i}=e;r&&(r.droppableId===s.droppableId&&r.index===s.index||(i===O.COLUMN?k(e):l(e)))},[S,C]=I.useState(!1),x=I.useRef(null);N("click",e=>{if(x.current&&!x.current.input?.contains(e.target)){const s=x.current.input?.value;s&&T({id:n.string.uuid(),title:s,taskIds:[]}),C(!1),console.log("click outside")}});const T=e=>{const s={...t,columns:{...t.columns,[e.id]:e},columnOrder:[...t.columnOrder,e.id]};a(s)},v=(e,s)=>{const r=t.columns[e],i={...t,tasks:{...t.tasks,[s.id]:s},columns:{...t.columns,[e]:{...r,taskIds:[...r.taskIds,s.id]}}};a(i)},D=e=>{const s=t.columns[e],r=Object.keys(t.tasks).filter(o=>!s.taskIds.includes(o)).reduce((o,d)=>(o[d]=t.tasks[d],o),{}),i=Object.keys(t.columns).filter(o=>o!==e).reduce((o,d)=>(o[d]=t.columns[d],o),{}),c=Array.from(t.columnOrder).filter(o=>o!==e);a({tasks:r,columns:i,columnOrder:c})},A=e=>{const s=t.columns[e],r=Object.keys(t.tasks).filter(m=>!s.taskIds.includes(m)).reduce((m,o)=>(m[o]=t.tasks[o],m),{}),i={...t.columns,[e]:{...s,taskIds:[]}},c={...t,tasks:r,columns:i};a(c)},E=e=>{const{id:s,title:r}=e,i={...t.columns,[s]:{...t.columns[s],title:r}},c={...t,columns:i};a(c)};return u.jsx(M,{children:u.jsxs("div",{className:"flex",children:[u.jsx(P,{onDragEnd:j,children:u.jsx(z,{droppableId:"all-columns",direction:"horizontal",type:O.COLUMN,children:e=>u.jsxs("div",{ref:e.innerRef,...e.droppableProps,className:"flex h-full items-start gap-6 p-1",children:[t.columnOrder.map((s,r)=>{const i=t.columns[s],c=i.taskIds.map(m=>t.tasks[m]);return u.jsx(B,{index:r,column:i,tasks:c,createTask:v,clearColumn:A,deleteColumn:D,renameColumn:E},s)}),e.placeholder]})})}),u.jsx("div",{className:"ml-[1.6rem] mt-[0.25rem] min-w-[280px]",children:S?u.jsx(H,{ref:x,size:"large",placeholder:"Column Name",autoFocus:!0}):u.jsxs(R,{onClick:e=>{e.stopPropagation(),C(!0)},className:"!inline-flex !w-full items-center justify-center !text-xs !font-semibold",block:!0,size:"large",children:[u.jsx(U,{icon:"carbon:add",size:20}),u.jsx("div",{children:"Add Column"})]})})]})})}export{rt as default};
